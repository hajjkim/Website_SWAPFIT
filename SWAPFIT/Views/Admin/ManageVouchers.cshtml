@model IEnumerable<SWAPFIT.Models.UuDai>

@{
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
    ViewData["Title"] = "Quản lý khuyến mãi";
}

<div class="container mt-5">
    <!-- TIÊU ĐỀ -->
    <h2 class="text-center fw-bold text-success mb-4">🎟️ Quản Lý Voucher</h2>

    <!-- Danh sách voucher -->
    <div class="table-responsive">
        <table class="table table-bordered table-striped align-middle">
            <thead class="table-primary">
                <tr>
                    <th>Tên Voucher</th>
                    <th>Mô Tả</th>
                    <th>Loại Ưu Đãi</th>
                    <th>Giá Trị</th>
                    <th>Ngày Bắt Đầu</th>
                    <th>Ngày Kết Thúc</th>
                    <th>Giới Hạn</th>
                    <th>Trạng Thái</th>
                    <th class="text-center">Thao Tác</th>
                </tr>
            </thead>
            <tbody>
                @if (Model != null)
                {
                    foreach (var voucher in Model)
                    {
                        <tr>
                            <td>@voucher.TenUuDai</td>
                            <td>@voucher.MoTa</td>
                            <td>@voucher.LoaiUuDai</td>
                            <td>@voucher.GiaTri.ToString("0")%</td>
                            <td>@voucher.NgayBatDau.ToString("dd/MM/yyyy")</td>
                            <td>@voucher.NgayKetThuc.ToString("dd/MM/yyyy")</td>

                            <td>
                                @(voucher.GioiHanSoLuong.HasValue
                                                        ? voucher.GioiHanSoLuong.Value.ToString()
                                                        : "Không giới hạn")
                    </td>

                            <td>
                                <span class="badge @(voucher.TrangThai == "HoatDong" ? "bg-success" : "bg-danger")">
                                    @voucher.TrangThai
                                </span>
                            </td>

                            <td class="text-center">
                                <form asp-action="DeleteVoucher"
                                      asp-controller="Admin"
                                      method="post"
                                      style="display:inline;">
                                    @Html.AntiForgeryToken()
                                    <input type="hidden" name="id" value="@voucher.MaUuDai" />
                                    <button type="submit"
                                            class="btn btn-danger btn-sm"
                                            onclick="return confirm('Bạn chắc chắn muốn xóa voucher này?');">
                                        🗑️ Xóa
                                    </button>
                                </form>
                            </td>
                        </tr>
                                }
                }
            </tbody>
        </table>
    </div>

    <!-- Thêm voucher mới -->
    <div class="card mt-4 shadow-sm">
        <div class="card-body">
            <h3 class="text-center text-success mb-4">Thêm Voucher Mới</h3>

            <form asp-action="CreateVoucher"
                  asp-controller="Admin"
                  method="post">
                @Html.AntiForgeryToken()

                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="TenUuDai">Tên Voucher</label>
                            <input type="text"
                                   name="tenUuDai"
                                   id="TenUuDai"
                                   class="form-control"
                                   required />
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="MoTa">Mô Tả</label>
                            <textarea name="moTa"
                                      id="MoTa"
                                      class="form-control"
                                      required></textarea>
                        </div>
                    </div>
                </div>

                <div class="row mt-1">
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="LoaiUuDai">Loại Ưu Đãi</label>
                            <select name="loaiUuDai"
                                    id="LoaiUuDai"
                                    class="form-control">
                                <option value="PhanTram">Phần trăm</option>
                                @* nếu sau này có loại khác thì thêm ở đây *@
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label for="GiaTri">Giá Trị (%)</label>
                            <input type="number"
                                   name="giaTri"
                                   id="GiaTri"
                                   class="form-control"
                                   min="1"
                                   max="100"
                                   required />
                        </div>
                    </div>
                </div>

                <div class="row mt-1">
                    <div class="col-md-4">
                        <div class="form-group mb-3">
                            <label for="NgayBatDau">Ngày Bắt Đầu</label>
                            <input type="date"
                                   name="ngayBatDau"
                                   id="NgayBatDau"
                                   class="form-control"
                                   required />
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group mb-3">
                            <label for="NgayKetThuc">Ngày Kết Thúc</label>
                            <input type="date"
                                   name="ngayKetThuc"
                                   id="NgayKetThuc"
                                   class="form-control"
                                   required />
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group mb-3">
                            <label for="GioiHanSoLuong">Giới hạn số lượng</label>
                            <input type="number"
                                   name="gioiHanSoLuong"
                                   id="GioiHanSoLuong"
                                   class="form-control"
                                   min="1"
                                   placeholder="Để trống nếu không giới hạn" />
                        </div>
                    </div>
                </div>

                <div class="d-flex justify-content-center mt-4">
                    <button type="submit" class="btn btn-success btn-lg">
                        Thêm Voucher
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
